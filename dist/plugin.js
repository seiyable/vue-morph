"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}function isFunction(t){return t&&"[object Function]"==={}.toString.call(t)}function validate(t){if("string"!=typeof t.targetElementId)return console.error("targetElementId is not set or an invalid value."),!1;var e=t.params;if(e&&"object"!==(void 0===e?"undefined":_typeof(e)))return console.error("params is not an object."),!1;var i=t.easing;if(i&&"string"!=typeof i)return console.error("easing is not set or an invalid value."),!1;var r=t.duration;if(r&&!Number.isInteger(r))return console.error("duration is not set or an invalid value."),!1;var n=t.callback;return!(n&&!isFunction(n))||(console.error("callback is not a function."),!1)}var anime=_interopDefault(require("animejs")),camelCase=_interopDefault(require("camelcase")),MorphingLayer={name:"morphing-layer",template:'<div v-show="isMorphing" :id="$vnode.componentOptions.tag" :style="getMorphingLayerStyle"></div>',data:function(){return{isMorphing:!1,svgWidth:0,svgHeight:0,origin:{},target:{},current:{}}},created:function(){this.initData()},computed:{getMorphingLayerStyle:function(){return{position:"fixed",left:0,right:0,top:0,bottom:0,width:"100%",height:"100%","z-index":9999}}},methods:{startMorphing:function(t){var e=t.originElement,i=t.targetElementId,r=t.params,n=t.easing,a=t.duration,o=t.className,s=t.callback;this.initData(),this.prepareData(e,i,r),this.addMorphDiv(o),this.morph(r,n,a,s)},initData:function(){this.isMorphing=!1,this.origin={},this.target={},this.current={}},prepareData:function(t,e,i){this.origin.el=t,this.target.el=document.getElementById(e);var r=this.origin.el.getBoundingClientRect();this.origin.absX=r.left,this.origin.absY=r.top,this.origin.w=this.origin.el.offsetWidth,this.origin.h=this.origin.el.offsetHeight;var n=this.target.el.getBoundingClientRect();this.target.absX=n.left,this.target.absY=n.top,this.target.w=this.target.el.offsetWidth,this.target.h=this.target.el.offsetHeight;var a=window.getComputedStyle(this.origin.el),o=window.getComputedStyle(this.target.el);for(var s in i){var l=i[s];this.origin[camelCase(s)]=a.getPropertyValue(s),this.target[camelCase(s)]=!0===l?o.getPropertyValue(s):this.origin[camelCase(s)]}},addMorphDiv:function(t){var e=document.createElement("div");e.setAttribute("class",t),e.style.position="absolute",this.current.el=e,this.$el.appendChild(this.current.el)},morph:function(t,e,i,r){var n=this;this.isMorphing=!0;var a={targets:this.current.el,left:[this.origin.absX+"px",this.target.absX+"px"],top:[this.origin.absY+"px",this.target.absY+"px"],width:[this.origin.w+"px",this.target.w+"px"],height:[this.origin.h+"px",this.target.h+"px"],easing:e,duration:i,loop:!1};for(var o in t){var s=camelCase(o);a[s]=[this.origin[s],this.target[s]]}anime(a).complete=function(){n.isMorphing=!1,n.$el.removeChild(n.current.el),r&&r()}}}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},plugin={install:function(t,e){var i=e.defaultEventType||"morph",r=e.morphingLayerName||"morphing-layer";t.directive("morph",{bind:function(t,n,a){t.addEventListener(i,function(i){var n=i.detail;if(validate(n)){a.context.$root.$children[0].$refs[r].startMorphing({originElement:t,targetElementId:n.targetElementId,params:n.params,easing:n.easing||e.defaultEasing||"linear",duration:n.duration||e.defaultDuration||1e3,className:n.className||e.defaultClassName||"morphing-div",callback:n.callback})}})},unbind:function(t,e,i){}}),t.component(r,MorphingLayer)}};module.exports=plugin;
